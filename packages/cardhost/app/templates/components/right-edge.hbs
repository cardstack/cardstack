<div class="right-edge" data-test-right-edge {{did-update this.updateCard @card @cardSelected}}>
  {{!-- TODO: make this a component --}}
  <div class="right-edge--pill-selector-container">
    <div class="pill-selector">
      <div class="pill-option selected">Properties</div>
      <div class="pill-option">Structure</div>
    </div>
  </div>
  <AnimatedContainer>
    {{#animated-value this.options watch="selectedContent" use=this.outerTransition}}
      <div class="right-edge--section--container">
        <AnimatedContainer>
          {{#animated-if @cardSelected use=this.fade duration=this.duration}}
            {{!--
            TODO each of these section is collapsable.
            Waiting until ember animated/liquid fire is available
            before implemnenting that, as that will make this easy
            --}}
            <div class="right-edge--sections">
              <div class="right-edge--section">
                <button {{on "click" (fn this.toggleSection "template")}} class="section-toggle-btn {{if (includes this.expandedSections "template") "expanded"}}" data-test-right-edge-section-toggle="template">
                  Toggle
                </button>
                <div class="right-edge--section-header" data-test-section-header>
                  Template
                </div>
                <AnimatedContainer class="right-edge--animation-container">
                  {{#animated-if (includes this.expandedSections "template") use=this.fade duration=this.duration}}
                    <div class="right-edge--items-container">
                      {{#if @card.adoptedFrom}}
                        <AdoptedFrom @card={{@card.adoptedFrom}} @adoptedCard={{@card}} />
                      {{else}}
                        <div data-test-no-adoption>
                          No Adoption
                        </div>
                      {{/if}}
                    </div>
                  {{/animated-if}}
                </AnimatedContainer>
              </div>
              {{#if (eq @mode "schema")}}
                <div class="right-edge--section">
                  <button {{on "click" (fn this.toggleSection "details")}} class="section-toggle-btn {{if (includes this.expandedSections "details") "expanded"}}" data-test-right-edge-section-toggle="details">
                    Toggle
                  </button>
                  <div class="right-edge--section-header" data-test-section-header>Details</div>
                  <AnimatedContainer class="right-edge--animation-container">
                    {{#animated-if (includes this.expandedSections "details") use=this.fade duration=this.duration}}
                      <div class="right-edge--items-container">
                        <div class="right-edge--item">
                          <TextField
                            @theme="cs-dark"
                            @class="hide-in-percy"
                            @id="card__id"
                            @label="Card ID"
                            @placeholder="e.g. millenial-puppies"
                            @value={{this.cardName}}
                            @setValue={{action this.updateCardId}}
                            @disabled={{or (not @updateCardId) (not @card.isNew)}} />
                        </div>
                        <div class="right-edge--item">
                          <div class="right-edge--label">Internal ID</div>
                          <div class="hide-in-percy" data-test-internal-card-id>
                            {{@card.id}}
                          </div>
                        </div>
                      </div>
                    {{/animated-if}}
                  </AnimatedContainer>
                </div>
              {{/if}}
            </div>
          {{else if @selectedField}}
            <div class="right-edge--sections">
              <AnimatedContainer>
                {{#animated-value @selectedField use=this.fade duration=this.duration as |field|}}
                  <div class="right-edge--section">
                    <div class="right-edge--section-header" data-test-section-header>
                      <AnimatedContainer>
                        {{#animated-value this.selectedFieldTitle use=this.fade duration=this.duration as |fieldTitle|}}
                          <div class="right-edge--selected-field-title">{{fieldTitle}} Field</div>
                        {{/animated-value}}
                      </AnimatedContainer>
                      {{#if field.isAdopted}}
                        <div class="right-edge--section-header--adopted">
                          Adopted from {{field.card.adoptedFrom.name}}
                        </div>
                      {{/if}}
                    </div>
                    <div class="right-edge--items-container">
                      <div class="right-edge--item">
                        <FieldRenderer
                          @field={{field}}
                          @mode="schema"
                          @setNeededWhenEmbedded={{@setNeededWhenEmbedded}}
                          @setFieldName={{@setFieldName}}
                          @setFieldLabel={{@setFieldLabel}}
                          @setFieldInstructions={{@setFieldInstructions}}
                          @schemaAttrs={{array "label" "name" "instructions" "embedded"}} />
                      </div>
                    </div>
                  </div>
                {{/animated-value}}
              </AnimatedContainer>
            </div>
          {{/animated-if}}
        </AnimatedContainer>
      </div>
    {{/animated-value}}
  </AnimatedContainer>
  {{yield}}
</div>