{{! template-lint-disable attribute-indentation}}
<div
  class="right-edge"
  data-test-right-edge
  {{did-update this.updateCard @card}}
>
  {{!-- TODO: make this a component --}}
  <div class="right-edge--pill-selector-container">
    <div class="pill-selector">
      <div class="pill-option selected">Properties</div>
      <div class="pill-option">Structure</div>
    </div>
  </div>
  {{#if @cardSelected}}
    {{!--
    TODO each of these section is collapsable.
    Waiting until ember animated/liquid fire is available
    before implemnenting that, as that will make this easy
    --}}
    <div class="right-edge--section">
      <div class="right-edge--section-header" data-test-section-header>ID</div>
      <div class="right-edge--item">
        <label for="card__id" class="ch-label">
          Card ID
        </label>
        <Input
          @id="card__id"
          @class="ch-input"
          @size="60"
          @placeholder="e.g. millenial-puppies"
          @value={{this.cardName}}
          @key-up={{action this.updateCardId}}
          @disabled={{or (not @updateCardId) (not @card.isNew)}}
        />
      </div>
      <div class="right-edge--item">
        <div class="ch-label right-edge--label">Internal ID</div>
        <div data-test-internal-card-id>
          {{@card.id}}
        </div>
      </div>
    </div>

    <div class="right-edge--section">
      <div class="right-edge--section-header" data-test-section-header>
        Template
      </div>
      <div class="right-edge--item">
        {{#if @card.adoptedFrom}}
          <AdoptedFrom @card={{@card.adoptedFrom}} />
        {{else}}
          <div data-test-no-adoption>
            No Adoption
          </div>
        {{/if}}
      </div>
    </div>
  {{else if @selectedField}}
    <div class="right-edge--section">
      <div class="right-edge--section-header" data-test-section-header>
        {{this.selectedFieldTitle}} Field
        {{#if @selectedField.isAdopted}}
          <div class="right-edge--section-header--adopted">
            Adopted from {{@selectedField.card.adoptedFrom.name}}
          </div>
        {{/if}}
      </div>

      <FieldRenderer
        @field={{@selectedField}}
        @mode="schema"
        @setNeededWhenEmbedded={{@setNeededWhenEmbedded}}
        @setFieldName={{@setFieldName}}
        @setFieldLabel={{@setFieldLabel}}
        @setFieldInstructions={{@setFieldInstructions}}
        @schemaAttrs={{array "name" "label" "instructions" "embedded"}}
      />
    </div>
  {{/if}}
  {{yield}}
</div>