<CardhostTopEdge @mode="schema">
  <div class="card-creator--top-edge">
    {{! eslint is confused by on helper }}
    {{! template-lint-disable attribute-indentation}}
    <button
      {{on "click" this.save}}
      class="cardhost-button primary"
      data-test-card-creator-save-btn
      disabled={{not this.cardstackSession.isAuthenticated}}
    >
      Save
    </button>

    {{#unless this.cardstackSession.isAuthenticated}}
      (Must be logged in to save the card.)
    {{/unless}}
  </div>
</CardhostTopEdge>

<CardhostLeftEdge>
  <section class="cardhost-left-edge--catalog">
    <h3 class="title">Card Catalog</h3>
    {{#each this.fieldComponents as |field|}}
      {{! eslint is confused by on helper }}
      {{! template-lint-disable attribute-indentation}}
      <section
        class="cardhost-left-edge--catalog-field"
        role="button"
        draggable="true"
        {{on "mousedown" (action this.beginDragging field)}}
        {{on "dragend" (action (mut this.isDragging) false)}}
        data-test-card-add-field-draggable={{field.type}}
      >
        {{! template-lint-disable no-inline-styles}}
        <div class="field-icon" style={{css-url "background-image" field.icon}}></div>
        <div class="field-content">
          <h4 class="field-content--title">{{field.title}}</h4>
          {{#if field.description}}
            <p class="field-content--description">{{field.description}}</p>
          {{/if}}
          <div class="field-content--type">Type: <code>{{field.type}}</code></div>
        </div>
      </section>
    {{/each}}
  </section>
</CardhostLeftEdge>

<aside class="cardhost-right-edge" data-test-cardhost-right-edge>
  <section class="cardhost-right-edge-panel">
    <h3 class="cardhost-right-edge-panel--header">
      Edit Field Schema
    </h3>
    {{#if this.selectedField}}
      <FieldRenderer
        @field={{this.selectedField}}
        @mode="schema"
        @setNeededWhenEmbedded={{action this.setNeededWhenEmbedded}}
        @setFieldName={{action this.setFieldName}}
      />
    {{/if}}
  </section>
</aside>

<div class="card-manipulator--container card-creator">
  {{#if this.statusMsg}}
    <p data-test-card-creator-msg><strong>{{this.statusMsg}}</strong></p>
  {{/if}}

  <fieldset class="card-creator--new-card">
    <legend>New Card</legend>
    <label for="card__id">Card ID:</label>
    <Input
      @id="card__id"
      @size="60"
      @placeholder="e.g. local-hub::article-card::millenial-puppies"
      @value={{this.cardId}}
      @key-up={{action this.updateCardId}}
    />
    <p>(Note that updating the card id will remove any fields that you have created. This is just a scaffolding limitation.)</p>
  </fieldset>

  {{#if this.card}}
    <section class="card-manipulator" data-test-card-creator>
      <header class="card-manipulator--header">
        <h2>New Card</h2>
        <code>{{@card.id}}</code>
      </header>
      <CardRenderer
        @card={{this.card}}
        @format="isolated"
        @mode="schema"
        @removeField={{action this.removeField}}
        @setPosition={{action this.setPosition}}
        @selectField={{action this.selectField}}
        @dropField={{action this.dropField}}
      />
    </section>
  {{/if}}

  {{#if this.card}}
    <section class="cardhost-card-document">
      <h3>Card Document</h3>
      <CodeBlock
        @code={{this.cardJson}}
        @language="javascript"
      />
    </section>
  {{/if}}
</div>