<CardhostTopEdge>
  <ModeSwitcher @name={{this.card.name}} @mode="schema" />
  <div>
    <div class="ch-button-group">
      {{! eslint is confused by on helper }}
      {{! template-lint-disable attribute-indentation}}
      <button
        {{on "click" this.cancel}}
        class="ch-button--secondary"
        disabled={{not this.cardstackSession.isAuthenticated}}
        data-test-card-schema-cancel-btn
      >
        Cancel
      </button>
      <button
        {{on "click" this.save}}
        disabled={{not this.cardstackSession.isAuthenticated}}
        data-test-card-schema-save-btn
      >
        Save
      </button>
    </div>
    <div>
      {{#unless this.cardstackSession.isAuthenticated}}
        (Must be logged in to save the card.)
      {{/unless}}
      <span data-test-card-schema-is-dirty={{this.isDirtyStr}}>
        {{#if this.card.isDirty}}(unsaved){{/if}}
      </span>
    </div>
  </div>
</CardhostTopEdge>

<CardhostLeftEdge>
  <section class="cardhost-left-edge--catalog">
    <h3 class="title">Card Catalog</h3>
    {{#each this.fieldComponents as |field|}}
      {{! eslint is confused by on helper }}
      {{! template-lint-disable attribute-indentation}}
      <section
        class="cardhost-left-edge--catalog-field"
        role="button"
        draggable="true"
        {{on "mousedown" (action this.beginDragging field)}}
        {{on "dragend" (action (mut this.isDragging) false)}}
        {{on "dragstart" (action this.firefoxDrag)}}
        data-test-card-add-field-draggable={{field.type}}
      >
        {{! template-lint-disable no-inline-styles}}
        <div class="field-icon" style={{css-url "background-image" field.icon}}></div>
        <div class="field-content">
          <h4 class="field-content--title">{{field.title}}</h4>
          {{#if field.description}}
            <p class="field-content--description">{{field.description}}</p>
          {{/if}}
          <div class="field-content--type">Type: <code>{{field.type}}</code></div>
        </div>
      </section>
    {{/each}}
  </section>
</CardhostLeftEdge>

<RightEdge
  @selectedField={{this.selectedField}}
  @selectField={{action this.selectField}}
  @setNeededWhenEmbedded={{this.setNeededWhenEmbedded}}
  @setFieldName={{this.setFieldName}}
  @setFieldLabel={{this.setFieldLabel}}
/>

<div class="card-manipulator--container card-schema-updator">
  {{#if this.statusMsg}}
    <p><strong>{{this.statusMsg}}</strong></p>
  {{/if}}

  <section class="card-manipulator" data-test-card-schema={{@card.name}}>
    <header class="card-manipulator--header">
      <h2>Card Schema</h2>
      <code>{{@card.name}}</code>
    </header>
    <CardRenderer
      @card={{this.card}}
      @format="isolated"
      @mode="schema"
      @removeField={{action this.removeField}}
      @setFieldName={{action this.setFieldName}}
      @setNeededWhenEmbedded={{action this.setNeededWhenEmbedded}}
      @selectField={{action this.selectField}}
      @setPosition={{action this.setPosition}}
      @dropField={{action this.dropField}}
    />
  </section>

  <section class="cardhost-card-document">
    <h3>Card Document</h3>
    <CodeBlock
      @code={{this.cardJson}}
      @language="javascript"
    />
  </section>
</div>