<section class="card-manipulator--container">
  {{!-- TODO: Need status message design --}}
  {{#if this.statusMsg}}
    <div><strong>{{this.statusMsg}}</strong></div>
  {{/if}}

  {{!-- Left edge --}}
  <aside class="cardhost-left-edge">
    <nav class="cardhost-left-edge--nav">
      <ul>
        <li><div class="profile icon"></div></li>
        <li><div class="catalog icon active"></div></li>
        <li><div class="library icon"></div></li>
      </ul>
    </nav>
    <section class="cardhost-left-edge--catalog">
      <h3 class="title">Card Catalog</h3>
      {{#each this.fieldComponents as |field|}}
        {{! eslint is confused by on helper }}
        {{! template-lint-disable attribute-indentation}}
        <section
          class="cardhost-left-edge--catalog-field"
          role="button"
          draggable="true"
          {{on "mousedown" (action this.beginDragging field)}}
          {{on "dragend" (action (mut this.isDragging) false)}}
          data-test-card-add-field-draggable={{field.type}}
        >
          {{! template-lint-disable no-inline-styles}}
          <div class="field-icon" style={{css-url "background-image" field.icon}}></div>
          <div class="field-content">
            <h4 class="field-content--title">{{field.title}}</h4>
            {{#if field.description}}
              <p class="field-content--description">{{field.description}}</p>
            {{/if}}
            <div class="field-content--type">Type: <code>{{field.type}}</code></div>
          </div>
        </section>
      {{/each}}
    </section>
  </aside>

  <nav class="card-manipulator--mode-nav">
    <div class="card-manipulator--mode-chooser">
      <div class="card-manipulator--mode-option schema">
        Schema View
      </div>
    </div>
  </nav>

  {{!-- Card --}}
  <section class="card-manipulator--card" data-test-card-schema={{@card.id}}>
    <header class="card-manipulator--card-header">
      <h2 class="title">Card Schema</h2>
      <code class="id">{{@card.id}}</code>
      {{!-- TODO: Move these to the right edge area? --}}
      <div>
        {{#unless this.cardstackSession.isAuthenticated}}
          (Must be logged in to save the card.)
        {{/unless}}
        <span data-test-card-schema-is-dirty={{this.isDirtyStr}}>
          {{#if this.card.isDirty}}(unsaved){{/if}}
        </span>
        {{! eslint is confused by on helper }}
        {{! template-lint-disable attribute-indentation}}
        <button
          {{on "click" this.save}}
          class="done-btn"
          disabled={{not this.cardstackSession.isAuthenticated}}
          data-test-card-schema-save-btn
        >
          Cancel
        </button>
        <button {{on "click" this.save}}
          disabled={{not this.cardstackSession.isAuthenticated}}
          data-test-card-schema-save-btn
        >
          Save
        </button>
      </div>
      {{!----}}
    </header>
    <CardRenderer
      @card={{this.card}}
      @format="isolated"
      @mode="schema"
      @removeField={{action this.removeField}}
      @setFieldName={{action this.setFieldName}}
      @setNeededWhenEmbedded={{action this.setNeededWhenEmbedded}}
      @setPosition={{action this.setPosition}}
      @dropField={{action this.dropField}}
    />
  </section>

  {{!-- Right edge --}}
  <aside class="cardhost-right-edge">
    <nav class="cardhost-right-edge--nav">
      <ul>
        <li>
          <LinkTo class="cardhost-button secondary" @route="cards.view" @model={{@card}}>View</LinkTo>
        </li>
      </ul>
    </nav>
    <section class="cardhost-right-edge-panel">
      <h3>Update Schema</h3>
    </section>
  </aside>
</section>

{{!-- TODO: Where to put this + need design --}}
<section class="cardhost-card-document">
  <h3>Card Document:</h3>
  <CodeBlock
    @code={{this.cardJson}}
    @language="javascript"
  />
</section>