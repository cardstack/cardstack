<CardhostTopEdge @mode="schema">
  <ModeSwitcher @name={{this.card.name}} @mode="schema" />
  {{#if this.cardstackSession.isAuthenticated}}
    <div class="card-renderer--top-edge-buttons">
      <div class="ch-button-group">
        {{! eslint is confused by on helper }}
        {{! template-lint-disable attribute-indentation}}
        <button
          class="ch-button ch-button--icon share"
          aria-label="Share button"
        >
        </button>
        <button
          {{on "click" this.cancel}}
          class="ch-button ch-button--secondary"
          disabled={{not this.cardstackSession.isAuthenticated}}
          data-test-card-schema-cancel-btn
        >
          Preview
        </button>
        <button
          {{on "click" this.save}}
          class="ch-button"
          disabled={{not this.cardstackSession.isAuthenticated}}
          data-test-card-schema-save-btn
        >
          Save
        </button>
      </div>
      <div>
        <span data-test-card-schema-is-dirty={{this.isDirtyStr}}>
          {{#if this.card.isDirty}}Unsaved.{{/if}}
        </span>
      </div>
    </div>
  {{/if}}
</CardhostTopEdge>

<CardhostLeftEdge @mode="schema">
  <section class="ch-catalog">
    <header class="ch-catalog--header">
      <h3 class="ch-catalog--title">Card Catalog</h3>
      <div class="ch-catalog--header-btns">
        {{! template-lint-disable attribute-indentation}}
        <button class="ch-catalog--header-btn sidebar active" aria-label="View as sidebar"></button>
        <button class="ch-catalog--header-btn grid" aria-label="View as grid"></button>
      </div>
      <div class="ch-filter-bar">Filter Results</div>
    </header>
    <div class="ch-catalog--fields">
      {{#each this.fieldComponents as |field|}}
        {{! eslint is confused by on helper }}
        {{! template-lint-disable attribute-indentation}}
        <div
          class="ch-catalog-field"
          role="button"
          draggable="true"
          {{on "mousedown" (action this.beginDragging field)}}
          {{on "dragend" (action (mut this.isDragging) false)}}
          {{on "dragstart" (action this.firefoxDrag)}}
          data-test-card-add-field-draggable={{field.type}}
        >
          {{! template-lint-disable no-inline-styles}}
          <div class="ch-catalog-field--icon" style={{css-url "background-image" field.icon}}></div>
          <div>
            <h4 class="ch-catalog-field--title">{{field.title}}</h4>
            {{#if field.description}}
              <p class="ch-catalog-field--description">{{field.description}}</p>
            {{/if}}
          </div>
        </div>
      {{/each}}
    </div>
  </section>
</CardhostLeftEdge>

<RightEdge
  @selectedField={{this.selectedField}}
  @selectField={{action this.selectField}}
  @setNeededWhenEmbedded={{this.setNeededWhenEmbedded}}
  @setFieldName={{this.setFieldName}}
  @setFieldLabel={{this.setFieldLabel}}
/>

<div class="ch-search-bar card-schema-updator--search-bar">Search Library</div>

<section class="card-schema-updator" data-test-card-schema={{@card.name}}>
  <CardRenderer
    @card={{this.card}}
    @format="isolated"
    @mode="schema"
    @removeField={{action this.removeField}}
    @setFieldName={{action this.setFieldName}}
    @setNeededWhenEmbedded={{action this.setNeededWhenEmbedded}}
    @selectField={{action this.selectField}}
    @setPosition={{action this.setPosition}}
    @dropField={{action this.dropField}}
  />
</section>

{{!-- Hidden --}}
<section class="cardhost-card-document">
  <h3>Card Document</h3>
  <CodeBlock
    class="cardhost-card-document--codeblock"
    @code={{this.cardJson}}
    @language="javascript"
  />
</section>