{{page-title "Merchant Services"}}

<section class="card-pay-dashboard" role="tabpanel" aria-labelledby="card-pay.merchant-services">
  <CardPay::DashboardPanel @panel={{@model.panel}}>
    {{#each @model.panel.sections as |section|}}
      <CardPay::DashboardPanel::Section @section={{section}}>
        <:cta>
          <Boxel::Button
            {{on "click" (set this "flow" section.workflow)}}
            @kind="primary"
            @size="touch"
            @disabled={{section.isCtaDisabled}}
            data-test-workflow-button={{section.workflow}}
          >
            {{section.cta}}
          </Boxel::Button>
        </:cta>
        <:disclaimer>
          {{#if (eq section.workflow 'request-payment')}}
            This is possible once you have connected your {{network-display-info "layer2" "fullName"}} wallet and created a merchant.
          {{/if}}
        </:disclaimer>
      </CardPay::DashboardPanel::Section>
    {{/each}}
  </CardPay::DashboardPanel>

  {{#if this.layer2Network.isConnected}}
    <section class="card-pay-dashboard__section" data-test-merchants-section>
      <h3 class="card-pay-dashboard__section-title">Merchant Services</h3>
      <div class="card-pay-dashboard__cards">
        {{!-- {{#each this.prepaidCards as |prepaidCard|}}
          <CardPay::PrepaidCardSafe @safe={{prepaidCard}} />
        {{/each}} --}}
      </div>
    </section>
  {{/if}}
</section>

<Boxel::Modal
  style={{css-var boxel-modal-max-width="65rem"}} {{!-- ~1040px --}}
  @isOpen={{eq this.flow 'create-merchant'}}
  @onClose={{set this 'flow' null}}
>
  {{#if (is-network-initialized)}}
    {{#if (eq this.flow 'create-merchant')}}
      <CardPay::CreateMerchantWorkflow />
    {{/if}}
  {{/if}}
</Boxel::Modal>